### 一、监控的意义与价值  
如何感知、如何定位、快速恢复  
- 单体（点）  
  -- FGC  
  -- 错误日志  
  -- 进程存活  
  -- 端口监听  
  
- 集群（面）  
  -- 链路异常  
  -- 请求耗时  
  -- 超时  
  -- 网络  
  -- QPS  
  -- I/O  
  
> 1.监控三大作用：  
> - 预警  
> - 定位  
> - 追溯  

> 2.监控的意义：  
> - 发现：第一时间发现系统异常。  
> - 排查：协助快速定位故障点。  
> - 维护：发现系统隐患。  

> 3.监控方向
> - 进程存活 
> supervisor(监控进程状态，如果进程挂了，则起子进程)
    ps aux|grep
    端口探测：telnet 端口号
> - 服务状态  
（模块假死）
    FGC
    语义监控（主动调模块接口，但要注意：如果请求类型是写，则有可能污染数据）--但不通用（各个接口都不同）
    探活协议（让框架层来实现：monitor调所有模块的探活接口，发探活请求）
> - 工作状态  
    错误数量（错误日志）
    执行耗时
    超时数量
    异常数量
    请求数量（流量波动告警）--要设计好告警的阈值  
> - 运行环境(硬件资源)  
    CPU  
    内存使用率  
    磁盘使用率，磁盘I/O  
    网络（eg.数据库的入口流量与出口流量监控,查询条件有问题，导致查出过多数据）  




### 二、监控方案设计实践  
1. 小规模系统监控方案
- 中控机配置告警参数
- 宿主机部署数据采集脚本
- 中控机定时调度数据采集

2. 大规模系统监控方案
- 平台配置告警策略
- 平台提供数据存储及绘图
- 宿主机自动采集上报数据
- 业务进程埋点（定时）上报  
  分平台侧及部署在宿主机上的agent两部分，
  agent负责采集数据，然后汇总上报到监控平台（监控平台侧分告警、数据固化两条线）。
  监控agent状态
>> 埋点：调监控接口去做数据收集的事情就叫做埋点  

优雅的迁移方案
ps：qps、error、delay属框架层的健康状态，则框架层的问题那就框架来解决
eg.使用责任链模式-filter  
而，业务相关的监控，就让业务主动去用SDK，进行主动上报  



### 三、选型方法论  
开源监控框架：
- Zabbix
- Open-Falcon（小米开源）
- Prometheus（监控） + Grafana（绘图工具）



